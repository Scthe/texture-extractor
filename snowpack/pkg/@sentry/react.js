import{l as U,m as le,S as g,u as de,_ as v,o as A,g as _,p as d,q as G,r as P,s as K,a as p,t as fe,v as he,w as ve,x as B,y as D,z as _e,k as X,A as me,B as k,C as N,D as ge,E as b,h as ye,b as M,F as J,c as Ee,G as be,H as x,I as T,J as z,K as V,L as q,M as Y}from"../common/hub-e13ed0b5.js";import{e as we,S as C,b as Se,w as ke,a as xe,d as $,f as Ie,g as Te}from"../common/eventbuilder-142cd26d.js";export{S as Severity,h as addBreadcrumb,a as captureException}from"../common/eventbuilder-142cd26d.js";import{s as Re,i as Oe,a as Fe,b as w}from"../common/instrument-ebfec453.js";var I;(function(n){n.Unknown="unknown",n.Skipped="skipped",n.Success="success",n.RateLimit="rate_limit",n.Invalid="invalid",n.Failed="failed"})(I||(I={})),function(n){function e(t){return t>=200&&t<300?n.Success:t===429?n.RateLimit:t>=400&&t<500?n.Invalid:t>=500?n.Failed:n.Unknown}n.fromHttpCode=e}(I||(I={}));var Ue=Object.setPrototypeOf||({__proto__:[]}instanceof Array?je:Ae);function je(n,e){return n.__proto__=e,n}function Ae(n,e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t]);return n}var h=function(n){U(e,n);function e(t){var r=this.constructor,i=n.call(this,t)||this;return i.message=t,i.name=r.prototype.constructor.name,Ue(i,r.prototype),i}return e}(Error),Be=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/,j="Invalid Dsn",Q=function(){function n(e){typeof e=="string"?this._fromString(e):this._fromComponents(e),this._validate()}return n.prototype.toString=function(e){e===void 0&&(e=!1);var t=this,r=t.host,i=t.path,o=t.pass,a=t.port,s=t.projectId,u=t.protocol,c=t.publicKey;return u+"://"+c+(e&&o?":"+o:"")+("@"+r+(a?":"+a:"")+"/"+(i&&i+"/")+s)},n.prototype._fromString=function(e){var t=Be.exec(e);if(!t)throw new h(j);var r=le(t.slice(1),6),i=r[0],o=r[1],a=r[2],s=a===void 0?"":a,u=r[3],c=r[4],l=c===void 0?"":c,f=r[5],y="",m=f,E=m.split("/");if(E.length>1&&(y=E.slice(0,-1).join("/"),m=E.pop()),m){var S=m.match(/^\d+/);S&&(m=S[0])}this._fromComponents({host:u,pass:s,path:y,projectId:m,port:l,protocol:i,publicKey:o})},n.prototype._fromComponents=function(e){"user"in e&&!("publicKey"in e)&&(e.publicKey=e.user),this.user=e.publicKey||"",this.protocol=e.protocol,this.publicKey=e.publicKey||"",this.pass=e.pass||"",this.host=e.host,this.port=e.port||"",this.path=e.path||"",this.projectId=e.projectId},n.prototype._validate=function(){var e=this;if(["protocol","publicKey","host","projectId"].forEach(function(t){if(!e[t])throw new h(j+": "+t+" missing")}),!this.projectId.match(/^\d+$/))throw new h(j+": Invalid projectId "+this.projectId);if(this.protocol!=="http"&&this.protocol!=="https")throw new h(j+": Invalid protocol "+this.protocol);if(this.port&&isNaN(parseInt(this.port,10)))throw new h(j+": Invalid port "+this.port)},n}(),Ce=function(){function n(e){this._limit=e,this._buffer=[]}return n.prototype.isReady=function(){return this._limit===void 0||this.length()<this._limit},n.prototype.add=function(e){var t=this;if(!this.isReady())return g.reject(new h("Not adding Promise due to buffer limit reached."));var r=e();return this._buffer.indexOf(r)===-1&&this._buffer.push(r),r.then(function(){return t.remove(r)}).then(null,function(){return t.remove(r).then(null,function(){})}),r},n.prototype.remove=function(e){var t=this._buffer.splice(this._buffer.indexOf(e),1)[0];return t},n.prototype.length=function(){return this._buffer.length},n.prototype.drain=function(e){var t=this;return new g(function(r){var i=setTimeout(function(){e&&e>0&&r(!1)},e);g.all(t._buffer).then(function(){clearTimeout(i),r(!0)}).then(null,function(){r(!0)})})},n}(),Z="7",ee=function(){function n(e,t,r){t===void 0&&(t={}),this.dsn=e,this._dsnObject=new Q(e),this.metadata=t,this._tunnel=r}return n.prototype.getDsn=function(){return this._dsnObject},n.prototype.forceEnvelope=function(){return!!this._tunnel},n.prototype.getBaseApiEndpoint=function(){var e=this.getDsn(),t=e.protocol?e.protocol+":":"",r=e.port?":"+e.port:"";return t+"//"+e.host+r+(e.path?"/"+e.path:"")+"/api/"},n.prototype.getStoreEndpoint=function(){return this._getIngestEndpoint("store")},n.prototype.getStoreEndpointWithUrlEncodedAuth=function(){return this.getStoreEndpoint()+"?"+this._encodedAuth()},n.prototype.getEnvelopeEndpointWithUrlEncodedAuth=function(){return this.forceEnvelope()?this._tunnel:this._getEnvelopeEndpoint()+"?"+this._encodedAuth()},n.prototype.getStoreEndpointPath=function(){var e=this.getDsn();return(e.path?"/"+e.path:"")+"/api/"+e.projectId+"/store/"},n.prototype.getRequestHeaders=function(e,t){var r=this.getDsn(),i=["Sentry sentry_version="+Z];return i.push("sentry_client="+e+"/"+t),i.push("sentry_key="+r.publicKey),r.pass&&i.push("sentry_secret="+r.pass),{"Content-Type":"application/json","X-Sentry-Auth":i.join(", ")}},n.prototype.getReportDialogEndpoint=function(e){e===void 0&&(e={});var t=this.getDsn(),r=this.getBaseApiEndpoint()+"embed/error-page/",i=[];i.push("dsn="+t.toString());for(var o in e)if(o!=="dsn")if(o==="user"){if(!e.user)continue;e.user.name&&i.push("name="+encodeURIComponent(e.user.name)),e.user.email&&i.push("email="+encodeURIComponent(e.user.email))}else i.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return i.length?r+"?"+i.join("&"):r},n.prototype._getEnvelopeEndpoint=function(){return this._getIngestEndpoint("envelope")},n.prototype._getIngestEndpoint=function(e){if(this._tunnel)return this._tunnel;var t=this.getBaseApiEndpoint(),r=this.getDsn();return""+t+r.projectId+"/"+e+"/"},n.prototype._encodedAuth=function(){var e=this.getDsn(),t={sentry_key:e.publicKey,sentry_version:Z};return de(t)},n}(),te=[];function re(n){return n.reduce(function(e,t){return e.every(function(r){return t.name!==r.name})&&e.push(t),e},[])}function He(n){var e=n.defaultIntegrations&&v(n.defaultIntegrations)||[],t=n.integrations,r=v(re(e));Array.isArray(t)?r=v(r.filter(function(a){return t.every(function(s){return s.name!==a.name})}),re(t)):typeof t=="function"&&(r=t(r),r=Array.isArray(r)?r:[r]);var i=r.map(function(a){return a.name}),o="Debug";return i.indexOf(o)!==-1&&r.push.apply(r,v(r.splice(i.indexOf(o),1))),r}function Le(n){te.indexOf(n.name)===-1&&(n.setupOnce(A,_),te.push(n.name),d.log("Integration installed: "+n.name))}function Pe(n){var e={};return He(n).forEach(function(t){e[t.name]=t,Le(t)}),e}var De=function(){function n(e,t){this._integrations={},this._processing=0,this._backend=new e(t),this._options=t,t.dsn&&(this._dsn=new Q(t.dsn))}return n.prototype.captureException=function(e,t,r){var i=this,o=t&&t.event_id;return this._process(this._getBackend().eventFromException(e,t).then(function(a){return i._captureEvent(a,t,r)}).then(function(a){o=a})),o},n.prototype.captureMessage=function(e,t,r,i){var o=this,a=r&&r.event_id,s=G(e)?this._getBackend().eventFromMessage(String(e),t,r):this._getBackend().eventFromException(e,r);return this._process(s.then(function(u){return o._captureEvent(u,r,i)}).then(function(u){a=u})),a},n.prototype.captureEvent=function(e,t,r){var i=t&&t.event_id;return this._process(this._captureEvent(e,t,r).then(function(o){i=o})),i},n.prototype.captureSession=function(e){if(!this._isEnabled()){d.warn("SDK not enabled, will not capture session.");return}typeof e.release!="string"?d.warn("Discarded session because of missing or non-string release"):(this._sendSession(e),e.update({init:!1}))},n.prototype.getDsn=function(){return this._dsn},n.prototype.getOptions=function(){return this._options},n.prototype.flush=function(e){var t=this;return this._isClientProcessing(e).then(function(r){return t._getBackend().getTransport().close(e).then(function(i){return r&&i})})},n.prototype.close=function(e){var t=this;return this.flush(e).then(function(r){return t.getOptions().enabled=!1,r})},n.prototype.setupIntegrations=function(){this._isEnabled()&&(this._integrations=Pe(this._options))},n.prototype.getIntegration=function(e){try{return this._integrations[e.id]||null}catch(t){return d.warn("Cannot retrieve integration "+e.id+" from the current Client"),null}},n.prototype._updateSessionFromEvent=function(e,t){var r,i,o=!1,a=!1,s=t.exception&&t.exception.values;if(s){a=!0;try{for(var u=P(s),c=u.next();!c.done;c=u.next()){var l=c.value,f=l.mechanism;if(f&&f.handled===!1){o=!0;break}}}catch(E){r={error:E}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}var y=e.status===K.Ok,m=y&&e.errors===0||y&&o;m&&(e.update(p(p({},o&&{status:K.Crashed}),{errors:e.errors||Number(a||o)})),this.captureSession(e))},n.prototype._sendSession=function(e){this._getBackend().sendSession(e)},n.prototype._isClientProcessing=function(e){var t=this;return new g(function(r){var i=0,o=1,a=setInterval(function(){t._processing==0?(clearInterval(a),r(!0)):(i+=o,e&&i>=e&&(clearInterval(a),r(!1)))},o)})},n.prototype._getBackend=function(){return this._backend},n.prototype._isEnabled=function(){return this.getOptions().enabled!==!1&&this._dsn!==void 0},n.prototype._prepareEvent=function(e,t,r){var i=this,o=this.getOptions().normalizeDepth,a=o===void 0?3:o,s=p(p({},e),{event_id:e.event_id||(r&&r.event_id?r.event_id:fe()),timestamp:e.timestamp||he()});this._applyClientOptions(s),this._applyIntegrationsMetadata(s);var u=t;r&&r.captureContext&&(u=ve.clone(u).update(r.captureContext));var c=g.resolve(s);return u&&(c=u.applyToEvent(s,r)),c.then(function(l){return typeof a=="number"&&a>0?i._normalizeEvent(l,a):l})},n.prototype._normalizeEvent=function(e,t){if(!e)return null;var r=p(p(p(p(p({},e),e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(function(i){return p(p({},i),i.data&&{data:B(i.data,t)})})}),e.user&&{user:B(e.user,t)}),e.contexts&&{contexts:B(e.contexts,t)}),e.extra&&{extra:B(e.extra,t)});return e.contexts&&e.contexts.trace&&(r.contexts.trace=e.contexts.trace),r},n.prototype._applyClientOptions=function(e){var t=this.getOptions(),r=t.environment,i=t.release,o=t.dist,a=t.maxValueLength,s=a===void 0?250:a;"environment"in e||(e.environment="environment"in t?r:"production"),e.release===void 0&&i!==void 0&&(e.release=i),e.dist===void 0&&o!==void 0&&(e.dist=o),e.message&&(e.message=D(e.message,s));var u=e.exception&&e.exception.values&&e.exception.values[0];u&&u.value&&(u.value=D(u.value,s));var c=e.request;c&&c.url&&(c.url=D(c.url,s))},n.prototype._applyIntegrationsMetadata=function(e){var t=Object.keys(this._integrations);t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=v(e.sdk.integrations||[],t))},n.prototype._sendEvent=function(e){this._getBackend().sendEvent(e)},n.prototype._captureEvent=function(e,t,r){return this._processEvent(e,t,r).then(function(i){return i.event_id},function(i){d.error(i)})},n.prototype._processEvent=function(e,t,r){var i=this,o=this.getOptions(),a=o.beforeSend,s=o.sampleRate;if(!this._isEnabled())return g.reject(new h("SDK not enabled, will not capture event."));var u=e.type==="transaction";return!u&&typeof s=="number"&&Math.random()>s?g.reject(new h("Discarding event because it's not included in the random sample (sampling rate = "+s+")")):this._prepareEvent(e,r,t).then(function(c){if(c===null)throw new h("An event processor returned null, will not send event.");var l=t&&t.data&&t.data.__sentry__===!0;if(l||u||!a)return c;var f=a(c,t);return i._ensureBeforeSendRv(f)}).then(function(c){if(c===null)throw new h("`beforeSend` returned `null`, will not send event.");var l=r&&r.getSession&&r.getSession();return!u&&l&&i._updateSessionFromEvent(l,c),i._sendEvent(c),c}).then(null,function(c){throw c instanceof h?c:(i.captureException(c,{data:{__sentry__:!0},originalException:c}),new h(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: `+c))})},n.prototype._process=function(e){var t=this;this._processing+=1,e.then(function(r){return t._processing-=1,r},function(r){return t._processing-=1,r})},n.prototype._ensureBeforeSendRv=function(e){var t="`beforeSend` method has to return `null` or a valid event.";if(_e(e))return e.then(function(r){if(!(X(r)||r===null))throw new h(t);return r},function(r){throw new h("beforeSend rejected with "+r)});if(!(X(e)||e===null))throw new h(t);return e},n}(),Ne=function(){function n(){}return n.prototype.sendEvent=function(e){return g.resolve({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:I.Skipped})},n.prototype.close=function(e){return g.resolve(!0)},n}(),Me=function(){function n(e){this._options=e,this._options.dsn||d.warn("No DSN provided, backend will not do anything."),this._transport=this._setupTransport()}return n.prototype.eventFromException=function(e,t){throw new h("Backend has to implement `eventFromException` method")},n.prototype.eventFromMessage=function(e,t,r){throw new h("Backend has to implement `eventFromMessage` method")},n.prototype.sendEvent=function(e){this._transport.sendEvent(e).then(null,function(t){d.error("Error while sending event: "+t)})},n.prototype.sendSession=function(e){if(!this._transport.sendSession){d.warn("Dropping session because custom transport doesn't implement sendSession");return}this._transport.sendSession(e).then(null,function(t){d.error("Error while sending session: "+t)})},n.prototype.getTransport=function(){return this._transport},n.prototype._setupTransport=function(){return new Ne},n}();function ne(n){if(!(!n.metadata||!n.metadata.sdk)){var e=n.metadata.sdk,t=e.name,r=e.version;return{name:t,version:r}}}function qe(n,e){return e&&(n.sdk=n.sdk||{},n.sdk.name=n.sdk.name||e.name,n.sdk.version=n.sdk.version||e.version,n.sdk.integrations=v(n.sdk.integrations||[],e.integrations||[]),n.sdk.packages=v(n.sdk.packages||[],e.packages||[])),n}function ie(n,e){var t=ne(e),r=JSON.stringify(p(p({sent_at:new Date().toISOString()},t&&{sdk:t}),e.forceEnvelope()&&{dsn:e.getDsn().toString()})),i="aggregates"in n?"sessions":"session",o=JSON.stringify({type:i});return{body:r+`
`+o+`
`+JSON.stringify(n),type:i,url:e.getEnvelopeEndpointWithUrlEncodedAuth()}}function oe(n,e){var t=ne(e),r=n.type||"event",i=r==="transaction"||e.forceEnvelope(),o=n.debug_meta||{},a=o.transactionSampling,s=me(o,["transactionSampling"]),u=a||{},c=u.method,l=u.rate;Object.keys(s).length===0?delete n.debug_meta:n.debug_meta=s;var f={body:JSON.stringify(t?qe(n,e.metadata.sdk):n),type:r,url:i?e.getEnvelopeEndpointWithUrlEncodedAuth():e.getStoreEndpointWithUrlEncodedAuth()};if(i){var y=JSON.stringify(p(p({event_id:n.event_id,sent_at:new Date().toISOString()},t&&{sdk:t}),e.forceEnvelope()&&{dsn:e.getDsn().toString()})),m=JSON.stringify({type:r,sample_rates:[{id:c,rate:l}]}),E=y+`
`+m+`
`+f.body;f.body=E}return f}function We(n,e){var t;e.debug===!0&&d.enable();var r=_();(t=r.getScope())===null||t===void 0||t.update(e.initialScope);var i=new n(e);r.bindClient(i)}var H="6.8.0",ae,Ge=function(){function n(){this.name=n.id}return n.prototype.setupOnce=function(){ae=Function.prototype.toString,Function.prototype.toString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.__sentry_original__||this;return ae.apply(r,e)}},n.id="FunctionToString",n}(),Ke=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],Xe=function(){function n(e){e===void 0&&(e={}),this._options=e,this.name=n.id}return n.prototype.setupOnce=function(){A(function(e){var t=_();if(!t)return e;var r=t.getIntegration(n);if(r){var i=t.getClient(),o=i?i.getOptions():{},a=typeof r._mergeOptions=="function"?r._mergeOptions(o):{};return typeof r._shouldDropEvent!="function"?e:r._shouldDropEvent(e,a)?null:e}return e})},n.prototype._shouldDropEvent=function(e,t){return this._isSentryError(e,t)?(d.warn(`Event dropped due to being internal Sentry Error.
Event: `+k(e)),!0):this._isIgnoredError(e,t)?(d.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+k(e)),!0):this._isDeniedUrl(e,t)?(d.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: "+k(e)+`.
Url: `+this._getEventFilterUrl(e)),!0):this._isAllowedUrl(e,t)?!1:(d.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: "+k(e)+`.
Url: `+this._getEventFilterUrl(e)),!0)},n.prototype._isSentryError=function(e,t){if(!t.ignoreInternal)return!1;try{return e&&e.exception&&e.exception.values&&e.exception.values[0]&&e.exception.values[0].type==="SentryError"||!1}catch(r){return!1}},n.prototype._isIgnoredError=function(e,t){return!t.ignoreErrors||!t.ignoreErrors.length?!1:this._getPossibleEventMessages(e).some(function(r){return t.ignoreErrors.some(function(i){return N(r,i)})})},n.prototype._isDeniedUrl=function(e,t){if(!t.denyUrls||!t.denyUrls.length)return!1;var r=this._getEventFilterUrl(e);return r?t.denyUrls.some(function(i){return N(r,i)}):!1},n.prototype._isAllowedUrl=function(e,t){if(!t.allowUrls||!t.allowUrls.length)return!0;var r=this._getEventFilterUrl(e);return r?t.allowUrls.some(function(i){return N(r,i)}):!0},n.prototype._mergeOptions=function(e){return e===void 0&&(e={}),{allowUrls:v(this._options.whitelistUrls||[],this._options.allowUrls||[],e.whitelistUrls||[],e.allowUrls||[]),denyUrls:v(this._options.blacklistUrls||[],this._options.denyUrls||[],e.blacklistUrls||[],e.denyUrls||[]),ignoreErrors:v(this._options.ignoreErrors||[],e.ignoreErrors||[],Ke),ignoreInternal:typeof this._options.ignoreInternal!="undefined"?this._options.ignoreInternal:!0}},n.prototype._getPossibleEventMessages=function(e){if(e.message)return[e.message];if(e.exception)try{var t=e.exception.values&&e.exception.values[0]||{},r=t.type,i=r===void 0?"":r,o=t.value,a=o===void 0?"":o;return[""+a,i+": "+a]}catch(s){return d.error("Cannot extract message for event "+k(e)),[]}return[]},n.prototype._getEventFilterUrl=function(e){try{if(e.stacktrace){var t=e.stacktrace.frames;return t&&t[t.length-1].filename||null}if(e.exception){var r=e.exception.values&&e.exception.values[0].stacktrace&&e.exception.values[0].stacktrace.frames;return r&&r[r.length-1].filename||null}return null}catch(i){return d.error("Cannot extract url for event "+k(e)),null}},n.id="InboundFilters",n}(),Je={event:"error",transaction:"transaction",session:"session",attachment:"attachment"},se=function(){function n(e){this.options=e,this._buffer=new Ce(30),this._rateLimits={},this._api=new ee(e.dsn,e._metadata,e.tunnel),this.url=this._api.getStoreEndpointWithUrlEncodedAuth()}return n.prototype.sendEvent=function(e){throw new h("Transport Class has to implement `sendEvent` method")},n.prototype.close=function(e){return this._buffer.drain(e)},n.prototype._handleResponse=function(e){var t=e.requestType,r=e.response,i=e.headers,o=e.resolve,a=e.reject,s=I.fromHttpCode(r.status),u=this._handleRateLimit(i);if(u&&d.warn("Too many "+t+" requests, backing off until: "+this._disabledUntil(t)),s===I.Success){o({status:s});return}a(r)},n.prototype._disabledUntil=function(e){var t=Je[e];return this._rateLimits[t]||this._rateLimits.all},n.prototype._isRateLimited=function(e){return this._disabledUntil(e)>new Date(Date.now())},n.prototype._handleRateLimit=function(e){var t,r,i,o,a=Date.now(),s=e["x-sentry-rate-limits"],u=e["retry-after"];if(s){try{for(var c=P(s.trim().split(",")),l=c.next();!l.done;l=c.next()){var f=l.value,y=f.split(":",2),m=parseInt(y[0],10),E=(isNaN(m)?60:m)*1e3;try{for(var S=(i=void 0,P(y[1].split(";"))),F=S.next();!F.done;F=S.next()){var pe=F.value;this._rateLimits[pe||"all"]=new Date(a+E)}}catch(L){i={error:L}}finally{try{F&&!F.done&&(o=S.return)&&o.call(S)}finally{if(i)throw i.error}}}}catch(L){t={error:L}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}return!0}else if(u)return this._rateLimits.all=new Date(a+ge(a,u)),!0;return!1},n}();function ze(){var n,e,t=b();if(Oe(t.fetch))return t.fetch.bind(t);var r=t.document,i=t.fetch;if(typeof((n=r)===null||n===void 0?void 0:n.createElement)=="function")try{var o=r.createElement("iframe");o.hidden=!0,r.head.appendChild(o),((e=o.contentWindow)===null||e===void 0?void 0:e.fetch)&&(i=o.contentWindow.fetch),r.head.removeChild(o)}catch(a){d.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",a)}return i.bind(t)}var Ve=function(n){U(e,n);function e(t,r){r===void 0&&(r=ze());var i=n.call(this,t)||this;return i._fetch=r,i}return e.prototype.sendEvent=function(t){return this._sendRequest(oe(t,this._api),t)},e.prototype.sendSession=function(t){return this._sendRequest(ie(t,this._api),t)},e.prototype._sendRequest=function(t,r){var i=this;if(this._isRateLimited(t.type))return Promise.reject({event:r,type:t.type,reason:"Transport for "+t.type+" requests locked till "+this._disabledUntil(t.type)+" due to too many requests.",status:429});var o={body:t.body,method:"POST",referrerPolicy:Re()?"origin":""};return this.options.fetchParameters!==void 0&&Object.assign(o,this.options.fetchParameters),this.options.headers!==void 0&&(o.headers=this.options.headers),this._buffer.add(function(){return new g(function(a,s){i._fetch(t.url,o).then(function(u){var c={"x-sentry-rate-limits":u.headers.get("X-Sentry-Rate-Limits"),"retry-after":u.headers.get("Retry-After")};i._handleResponse({requestType:t.type,response:u,headers:c,resolve:a,reject:s})}).catch(s)})})},e}(se),Ye=function(n){U(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.sendEvent=function(t){return this._sendRequest(oe(t,this._api),t)},e.prototype.sendSession=function(t){return this._sendRequest(ie(t,this._api),t)},e.prototype._sendRequest=function(t,r){var i=this;return this._isRateLimited(t.type)?Promise.reject({event:r,type:t.type,reason:"Transport for "+t.type+" requests locked till "+this._disabledUntil(t.type)+" due to too many requests.",status:429}):this._buffer.add(function(){return new g(function(o,a){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===4){var c={"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")};i._handleResponse({requestType:t.type,response:s,headers:c,resolve:o,reject:a})}},s.open("POST",t.url);for(var u in i.options.headers)i.options.headers.hasOwnProperty(u)&&s.setRequestHeader(u,i.options.headers[u]);s.send(t.body)})})},e}(se),$e=function(n){U(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.eventFromException=function(t,r){return we(this._options,t,r)},e.prototype.eventFromMessage=function(t,r,i){return r===void 0&&(r=C.Info),Se(this._options,t,r,i)},e.prototype._setupTransport=function(){if(!this._options.dsn)return n.prototype._setupTransport.call(this);var t=p(p({},this._options.transportOptions),{dsn:this._options.dsn,tunnel:this._options.tunnel,_metadata:this._options._metadata});return this._options.transport?new this._options.transport(t):Fe()?new Ve(t):new Ye(t)},e}(Me),W=0;function ue(){return W>0}function Qe(){W+=1,setTimeout(function(){W-=1})}function R(n,e,t){if(e===void 0&&(e={}),typeof n!="function")return n;try{if(n.__sentry__)return n;if(n.__sentry_wrapped__)return n.__sentry_wrapped__}catch(a){return n}var r=function(){var a=Array.prototype.slice.call(arguments);try{t&&typeof t=="function"&&t.apply(this,arguments);var s=a.map(function(u){return R(u,e)});return n.handleEvent?n.handleEvent.apply(this,s):n.apply(this,s)}catch(u){throw Qe(),ke(function(c){c.addEventProcessor(function(l){var f=p({},l);return e.mechanism&&(ye(f,void 0,void 0),M(f,e.mechanism)),f.extra=p(p({},f.extra),{arguments:a}),f}),xe(u)}),u}};try{for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}catch(a){}n.prototype=n.prototype||{},r.prototype=n.prototype,Object.defineProperty(n,"__sentry_wrapped__",{enumerable:!1,value:r}),Object.defineProperties(r,{__sentry__:{enumerable:!1,value:!0},__sentry_original__:{enumerable:!1,value:n}});try{var o=Object.getOwnPropertyDescriptor(r,"name");o.configurable&&Object.defineProperty(r,"name",{get:function(){return n.name}})}catch(a){}return r}function Ze(n){if(n===void 0&&(n={}),!n.eventId){d.error("Missing eventId option in showReportDialog call");return}if(!n.dsn){d.error("Missing dsn option in showReportDialog call");return}var e=document.createElement("script");e.async=!0,e.src=new ee(n.dsn).getReportDialogEndpoint(n),n.onLoad&&(e.onload=n.onLoad),(document.head||document.body).appendChild(e)}var et=function(){function n(e){this.name=n.id,this._onErrorHandlerInstalled=!1,this._onUnhandledRejectionHandlerInstalled=!1,this._options=p({onerror:!0,onunhandledrejection:!0},e)}return n.prototype.setupOnce=function(){Error.stackTraceLimit=50,this._options.onerror&&(d.log("Global Handler attached: onerror"),this._installGlobalOnErrorHandler()),this._options.onunhandledrejection&&(d.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler())},n.prototype._installGlobalOnErrorHandler=function(){var e=this;this._onErrorHandlerInstalled||(w({callback:function(t){var r=t.error,i=_(),o=i.getIntegration(n),a=r&&r.__sentry_own_request__===!0;if(!(!o||ue()||a)){var s=i.getClient(),u=r===void 0&&J(t.msg)?e._eventFromIncompleteOnError(t.msg,t.url,t.line,t.column):e._enhanceEventWithInitialFrame($(r||t.msg,void 0,{attachStacktrace:s&&s.getOptions().attachStacktrace,rejection:!1}),t.url,t.line,t.column);M(u,{handled:!1,type:"onerror"}),i.captureEvent(u,{originalException:r})}},type:"error"}),this._onErrorHandlerInstalled=!0)},n.prototype._installGlobalOnUnhandledRejectionHandler=function(){var e=this;this._onUnhandledRejectionHandlerInstalled||(w({callback:function(t){var r=t;try{"reason"in t?r=t.reason:"detail"in t&&"reason"in t.detail&&(r=t.detail.reason)}catch(c){}var i=_(),o=i.getIntegration(n),a=r&&r.__sentry_own_request__===!0;if(!o||ue()||a)return!0;var s=i.getClient(),u=G(r)?e._eventFromRejectionWithPrimitive(r):$(r,void 0,{attachStacktrace:s&&s.getOptions().attachStacktrace,rejection:!0});u.level=C.Error,M(u,{handled:!1,type:"onunhandledrejection"}),i.captureEvent(u,{originalException:r})},type:"unhandledrejection"}),this._onUnhandledRejectionHandlerInstalled=!0)},n.prototype._eventFromIncompleteOnError=function(e,t,r,i){var o=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i,a=Ee(e)?e.message:e,s,u=a.match(o);u&&(s=u[1],a=u[2]);var c={exception:{values:[{type:s||"Error",value:a}]}};return this._enhanceEventWithInitialFrame(c,t,r,i)},n.prototype._eventFromRejectionWithPrimitive=function(e){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(e)}]}}},n.prototype._enhanceEventWithInitialFrame=function(e,t,r,i){e.exception=e.exception||{},e.exception.values=e.exception.values||[],e.exception.values[0]=e.exception.values[0]||{},e.exception.values[0].stacktrace=e.exception.values[0].stacktrace||{},e.exception.values[0].stacktrace.frames=e.exception.values[0].stacktrace.frames||[];var o=isNaN(parseInt(i,10))?void 0:i,a=isNaN(parseInt(r,10))?void 0:r,s=J(t)&&t.length>0?t:be();return e.exception.values[0].stacktrace.frames.length===0&&e.exception.values[0].stacktrace.frames.push({colno:o,filename:s,function:"?",in_app:!0,lineno:a}),e},n.id="GlobalHandlers",n}(),tt=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],rt=function(){function n(e){this.name=n.id,this._options=p({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0},e)}return n.prototype.setupOnce=function(){var e=b();if(this._options.setTimeout&&x(e,"setTimeout",this._wrapTimeFunction.bind(this)),this._options.setInterval&&x(e,"setInterval",this._wrapTimeFunction.bind(this)),this._options.requestAnimationFrame&&x(e,"requestAnimationFrame",this._wrapRAF.bind(this)),this._options.XMLHttpRequest&&"XMLHttpRequest"in e&&x(XMLHttpRequest.prototype,"send",this._wrapXHR.bind(this)),this._options.eventTarget){var t=Array.isArray(this._options.eventTarget)?this._options.eventTarget:tt;t.forEach(this._wrapEventTarget.bind(this))}},n.prototype._wrapTimeFunction=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t[0];return t[0]=R(i,{mechanism:{data:{function:T(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}},n.prototype._wrapRAF=function(e){return function(t){return e.call(this,R(t,{mechanism:{data:{function:"requestAnimationFrame",handler:T(e)},handled:!0,type:"instrument"}}))}},n.prototype._wrapEventTarget=function(e){var t=b(),r=t[e]&&t[e].prototype;!r||!r.hasOwnProperty||!r.hasOwnProperty("addEventListener")||(x(r,"addEventListener",function(i){return function(o,a,s){try{typeof a.handleEvent=="function"&&(a.handleEvent=R(a.handleEvent.bind(a),{mechanism:{data:{function:"handleEvent",handler:T(a),target:e},handled:!0,type:"instrument"}}))}catch(u){}return i.call(this,o,R(a,{mechanism:{data:{function:"addEventListener",handler:T(a),target:e},handled:!0,type:"instrument"}}),s)}}),x(r,"removeEventListener",function(i){return function(o,a,s){var u,c=a;try{var l=(u=c)===null||u===void 0?void 0:u.__sentry_wrapped__;l&&i.call(this,o,l,s)}catch(f){}return i.call(this,o,c,s)}}))},n.prototype._wrapXHR=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=this,o=["onload","onerror","onprogress","onreadystatechange"];return o.forEach(function(a){a in i&&typeof i[a]=="function"&&x(i,a,function(s){var u={mechanism:{data:{function:a,handler:T(s)},handled:!0,type:"instrument"}};return s.__sentry_original__&&(u.mechanism.data.handler=T(s.__sentry_original__)),R(s,u)})}),e.apply(this,t)}},n.id="TryCatch",n}(),ce=function(){function n(e){this.name=n.id,this._options=p({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},e)}return n.prototype.addSentryBreadcrumb=function(e){!this._options.sentry||_().addBreadcrumb({category:"sentry."+(e.type==="transaction"?"transaction":"event"),event_id:e.event_id,level:e.level,message:k(e)},{event:e})},n.prototype.setupOnce=function(){var e=this;this._options.console&&w({callback:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e._consoleBreadcrumb.apply(e,v(t))},type:"console"}),this._options.dom&&w({callback:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e._domBreadcrumb.apply(e,v(t))},type:"dom"}),this._options.xhr&&w({callback:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e._xhrBreadcrumb.apply(e,v(t))},type:"xhr"}),this._options.fetch&&w({callback:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e._fetchBreadcrumb.apply(e,v(t))},type:"fetch"}),this._options.history&&w({callback:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e._historyBreadcrumb.apply(e,v(t))},type:"history"})},n.prototype._consoleBreadcrumb=function(e){var t={category:"console",data:{arguments:e.args,logger:"console"},level:C.fromString(e.level),message:z(e.args," ")};if(e.level==="assert")if(e.args[0]===!1)t.message="Assertion failed: "+(z(e.args.slice(1)," ")||"console.assert"),t.data.arguments=e.args.slice(1);else return;_().addBreadcrumb(t,{input:e.args,level:e.level})},n.prototype._domBreadcrumb=function(e){var t,r=typeof this._options.dom=="object"?this._options.dom.serializeAttribute:void 0;typeof r=="string"&&(r=[r]);try{t=e.event.target?V(e.event.target,r):V(e.event,r)}catch(i){t="<unknown>"}t.length!==0&&_().addBreadcrumb({category:"ui."+e.name,message:t},{event:e.event,name:e.name,global:e.global})},n.prototype._xhrBreadcrumb=function(e){if(e.endTimestamp){if(e.xhr.__sentry_own_request__)return;var t=e.xhr.__sentry_xhr__||{},r=t.method,i=t.url,o=t.status_code,a=t.body;_().addBreadcrumb({category:"xhr",data:{method:r,url:i,status_code:o},type:"http"},{xhr:e.xhr,input:a});return}},n.prototype._fetchBreadcrumb=function(e){!e.endTimestamp||e.fetchData.url.match(/sentry_key/)&&e.fetchData.method==="POST"||(e.error?_().addBreadcrumb({category:"fetch",data:e.fetchData,level:C.Error,type:"http"},{data:e.error,input:e.args}):_().addBreadcrumb({category:"fetch",data:p(p({},e.fetchData),{status_code:e.response.status}),type:"http"},{input:e.args,response:e.response}))},n.prototype._historyBreadcrumb=function(e){var t=b(),r=e.from,i=e.to,o=q(t.location.href),a=q(r),s=q(i);a.path||(a=o),o.protocol===s.protocol&&o.host===s.host&&(i=s.relative),o.protocol===a.protocol&&o.host===a.host&&(r=a.relative),_().addBreadcrumb({category:"navigation",data:{from:r,to:i}})},n.id="Breadcrumbs",n}(),nt="cause",it=5,ot=function(){function n(e){e===void 0&&(e={}),this.name=n.id,this._key=e.key||nt,this._limit=e.limit||it}return n.prototype.setupOnce=function(){A(function(e,t){var r=_().getIntegration(n);return r?r._handler(e,t):e})},n.prototype._handler=function(e,t){if(!e.exception||!e.exception.values||!t||!Y(t.originalException,Error))return e;var r=this._walkErrorTree(t.originalException,this._key);return e.exception.values=v(r,e.exception.values),e},n.prototype._walkErrorTree=function(e,t,r){if(r===void 0&&(r=[]),!Y(e[t],Error)||r.length+1>=this._limit)return r;var i=Ie(e[t]),o=Te(i);return this._walkErrorTree(e[t],t,v([o],r))},n.id="LinkedErrors",n}(),O=b(),at=function(){function n(){this.name=n.id}return n.prototype.setupOnce=function(){A(function(e){var t,r,i;if(_().getIntegration(n)){if(!O.navigator&&!O.location&&!O.document)return e;var o=((t=e.request)===null||t===void 0?void 0:t.url)||((r=O.location)===null||r===void 0?void 0:r.href),a=(O.document||{}).referrer,s=(O.navigator||{}).userAgent,u=p(p(p({},(i=e.request)===null||i===void 0?void 0:i.headers),a&&{Referer:a}),s&&{"User-Agent":s}),c=p(p({},o&&{url:o}),{headers:u});return p(p({},e),{request:c})}return e})},n.id="UserAgent",n}(),st=function(){function n(){this.name=n.id}return n.prototype.setupOnce=function(e,t){e(function(r){var i=t().getIntegration(n);if(i){try{if(i._shouldDropEvent(r,i._previousEvent))return null}catch(o){return i._previousEvent=r}return i._previousEvent=r}return r})},n.prototype._shouldDropEvent=function(e,t){return t?!!(this._isSameMessageEvent(e,t)||this._isSameExceptionEvent(e,t)):!1},n.prototype._isSameMessageEvent=function(e,t){var r=e.message,i=t.message;return!(!r&&!i||r&&!i||!r&&i||r!==i||!this._isSameFingerprint(e,t)||!this._isSameStacktrace(e,t))},n.prototype._getFramesFromEvent=function(e){var t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(r){return}else if(e.stacktrace)return e.stacktrace.frames},n.prototype._isSameStacktrace=function(e,t){var r=this._getFramesFromEvent(e),i=this._getFramesFromEvent(t);if(!r&&!i)return!0;if(r&&!i||!r&&i||(r=r,i=i,i.length!==r.length))return!1;for(var o=0;o<i.length;o++){var a=i[o],s=r[o];if(a.filename!==s.filename||a.lineno!==s.lineno||a.colno!==s.colno||a.function!==s.function)return!1}return!0},n.prototype._getExceptionFromEvent=function(e){return e.exception&&e.exception.values&&e.exception.values[0]},n.prototype._isSameExceptionEvent=function(e,t){var r=this._getExceptionFromEvent(t),i=this._getExceptionFromEvent(e);return!(!r||!i||r.type!==i.type||r.value!==i.value||!this._isSameFingerprint(e,t)||!this._isSameStacktrace(e,t))},n.prototype._isSameFingerprint=function(e,t){var r=e.fingerprint,i=t.fingerprint;if(!r&&!i)return!0;if(r&&!i||!r&&i)return!1;r=r,i=i;try{return r.join("")===i.join("")}catch(o){return!1}},n.id="Dedupe",n}(),ut=function(n){U(e,n);function e(t){t===void 0&&(t={});var r=this;return t._metadata=t._metadata||{},t._metadata.sdk=t._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:"npm:@sentry/browser",version:H}],version:H},r=n.call(this,$e,t)||this,r}return e.prototype.showReportDialog=function(t){t===void 0&&(t={});var r=b().document;if(!!r){if(!this._isEnabled()){d.error("Trying to call showReportDialog with Sentry Client disabled");return}Ze(p(p({},t),{dsn:t.dsn||this.getDsn()}))}},e.prototype._prepareEvent=function(t,r,i){return t.platform=t.platform||"javascript",n.prototype._prepareEvent.call(this,t,r,i)},e.prototype._sendEvent=function(t){var r=this.getIntegration(ce);r&&r.addSentryBreadcrumb(t),n.prototype._sendEvent.call(this,t)},e}(De),ct=[new Xe,new Ge,new rt,new ce,new et,new ot,new st,new at];function pt(n){if(n===void 0&&(n={}),n.defaultIntegrations===void 0&&(n.defaultIntegrations=ct),n.release===void 0){var e=b();e.SENTRY_RELEASE&&e.SENTRY_RELEASE.id&&(n.release=e.SENTRY_RELEASE.id)}n.autoSessionTracking===void 0&&(n.autoSessionTracking=!0),We(ut,n),n.autoSessionTracking&&lt()}function lt(){var n=b(),e=n.document;if(typeof e=="undefined"){d.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}var t=_();typeof t.startSession!="function"||typeof t.captureSession!="function"||(t.startSession({ignoreDuration:!0}),t.captureSession(),w({callback:function(r){var i=r.from,o=r.to;i===void 0||i===o||(t.startSession({ignoreDuration:!0}),t.captureSession())},type:"history"}))}function dt(n){n._metadata=n._metadata||{},n._metadata.sdk=n._metadata.sdk||{name:"sentry.javascript.react",packages:[{name:"npm:@sentry/react",version:H}],version:H},pt(n)}export{dt as init};
